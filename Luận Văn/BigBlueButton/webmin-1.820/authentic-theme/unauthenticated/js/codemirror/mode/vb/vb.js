(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineMode("vb",function(m,A){var c="error";function q(H){return new RegExp("^(("+H.join(")|(")+"))\\b","i")}var p=new RegExp("^[\\+\\-\\*/%&\\\\|\\^~<>!]");var u=new RegExp("^[\\(\\)\\[\\]\\{\\}@,:`=;\\.]");var b=new RegExp("^((==)|(<>)|(<=)|(>=)|(<>)|(<<)|(>>)|(//)|(\\*\\*))");var j=new RegExp("^((\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))");var D=new RegExp("^((//=)|(>>=)|(<<=)|(\\*\\*=))");var i=new RegExp("^[_A-Za-z][_A-Za-z0-9]*");var w=["class","module","sub","enum","select","while","if","function","get","set","property","try"];var s=["else","elseif","case","catch"];var G=["next","loop"];var t=["and","or","not","xor","in"];var e=q(t);var z=["as","dim","break","continue","optional","then","until","goto","byval","byref","new","handles","property","return","const","private","protected","friend","public","shared","static","true","false"];var x=["integer","string","double","decimal","boolean","short","char","float","single"];var k=q(z);var o=q(x);var l='"';var v=q(w);var C=q(s);var h=q(G);var r=q(["end"]);var d=q(["do"]);var B=null;a.registerHelper("hintWords","vb",w.concat(s).concat(G).concat(t).concat(z).concat(x));function n(H,I){I.currentIndent++}function f(H,I){I.currentIndent--}function F(L,K){if(L.eatSpace()){return null}var J=L.peek();if(J==="'"){L.skipToEnd();return"comment"}if(L.match(/^((&H)|(&O))?[0-9\.a-f]/i,false)){var I=false;if(L.match(/^\d*\.\d+F?/i)){I=true}else{if(L.match(/^\d+\.\d*F?/)){I=true}else{if(L.match(/^\.\d+F?/)){I=true}}}if(I){L.eat(/J/i);return"number"}var H=false;if(L.match(/^&H[0-9a-f]+/i)){H=true}else{if(L.match(/^&O[0-7]+/i)){H=true}else{if(L.match(/^[1-9]\d*F?/)){L.eat(/J/i);H=true}else{if(L.match(/^0(?![\dx])/i)){H=true}}}}if(H){L.eat(/L/i);return"number"}}if(L.match(l)){K.tokenize=y(L.current());return K.tokenize(L,K)}if(L.match(D)||L.match(j)){return null}if(L.match(b)||L.match(p)||L.match(e)){return"operator"}if(L.match(u)){return null}if(L.match(d)){n(L,K);K.doInCurrentLine=true;return"keyword"}if(L.match(v)){if(!K.doInCurrentLine){n(L,K)}else{K.doInCurrentLine=false}return"keyword"}if(L.match(C)){return"keyword"}if(L.match(r)){f(L,K);f(L,K);return"keyword"}if(L.match(h)){f(L,K);return"keyword"}if(L.match(o)){return"keyword"}if(L.match(k)){return"keyword"}if(L.match(i)){return"variable"}L.next();return c}function y(H){var J=H.length==1;var I="string";return function(L,K){while(!L.eol()){L.eatWhile(/[^'"]/);if(L.match(H)){K.tokenize=F;return I}else{L.eat(/['"]/)}}if(J){if(A.singleLineStringErrors){return c}else{K.tokenize=F}}return I}}function E(L,J){var I=J.tokenize(L,J);var K=L.current();if(K==="."){I=J.tokenize(L,J);K=L.current();if(I==="variable"){return"variable"}else{return c}}var H="[({".indexOf(K);if(H!==-1){n(L,J)}if(B==="dedent"){if(f(L,J)){return c}}H="])}".indexOf(K);if(H!==-1){if(f(L,J)){return c}}return I}var g={electricChars:"dDpPtTfFeE ",startState:function(){return{tokenize:F,lastToken:null,currentIndent:0,nextLineIndent:0,doInCurrentLine:false}},token:function(J,I){if(J.sol()){I.currentIndent+=I.nextLineIndent;I.nextLineIndent=0;I.doInCurrentLine=0}var H=E(J,I);I.lastToken={style:H,content:J.current()};return H},indent:function(J,H){var I=H.replace(/^\s+|\s+$/g,"");if(I.match(h)||I.match(r)||I.match(C)){return m.indentUnit*(J.currentIndent-1)}if(J.currentIndent<0){return 0}return J.currentIndent*m.indentUnit},lineComment:"'"};return g});a.defineMIME("text/x-vb","vb")});