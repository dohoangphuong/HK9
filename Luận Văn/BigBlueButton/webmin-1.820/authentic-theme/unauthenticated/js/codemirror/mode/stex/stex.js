(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineMode("stex",function(){function j(l,m){l.cmdState.push(m)}function h(l){if(l.cmdState.length>0){return l.cmdState[l.cmdState.length-1]}else{return null}}function k(m){var l=m.cmdState.pop();if(l){l.closeBracket()}}function b(o){var n=o.cmdState;for(var m=n.length-1;m>=0;m--){var l=n[m];if(l.name=="DEFAULT"){continue}return l}return{styleIdentifier:function(){return null}}}function c(n,m,l){return function(){this.name=n;this.bracketNo=0;this.style=m;this.styles=l;this.argument=null;this.styleIdentifier=function(){return this.styles[this.bracketNo-1]||null};this.openBracket=function(){this.bracketNo++;return"bracket"};this.closeBracket=function(){}}}var d={};d.importmodule=c("importmodule","tag",["string","builtin"]);d.documentclass=c("documentclass","tag",["","atom"]);d.usepackage=c("usepackage","tag",["atom"]);d.begin=c("begin","tag",["atom"]);d.end=c("end","tag",["atom"]);d.DEFAULT=function(){this.name="DEFAULT";this.style="tag";this.styleIdentifier=this.openBracket=this.closeBracket=function(){}};function e(m,l){m.f=l}function f(p,o){var l;if(p.match(/^\\[a-zA-Z@]+/)){var m=p.current().slice(1);l=d[m]||d.DEFAULT;l=new l();j(o,l);e(o,g);return l.style}if(p.match(/^\\[$&%#{}_]/)){return"tag"}if(p.match(/^\\[,;!\/\\]/)){return"tag"}if(p.match("\\[")){e(o,function(r,q){return i(r,q,"\\]")});return"keyword"}if(p.match("$$")){e(o,function(r,q){return i(r,q,"$$")});return"keyword"}if(p.match("$")){e(o,function(r,q){return i(r,q,"$")});return"keyword"}var n=p.next();if(n=="%"){p.skipToEnd();return"comment"}else{if(n=="}"||n=="]"){l=h(o);if(l){l.closeBracket(n);e(o,g)}else{return"error"}return"bracket"}else{if(n=="{"||n=="["){l=d.DEFAULT;l=new l();j(o,l);return"bracket"}else{if(/\d/.test(n)){p.eatWhile(/[\w.%]/);return"atom"}else{p.eatWhile(/[\w\-_]/);l=b(o);if(l.name=="begin"){l.argument=p.current()}return l.styleIdentifier()}}}}}function i(n,m,o){if(n.eatSpace()){return null}if(n.match(o)){e(m,f);return"keyword"}if(n.match(/^\\[a-zA-Z@]+/)){return"tag"}if(n.match(/^[a-zA-Z]+/)){return"variable-2"}if(n.match(/^\\[$&%#{}_]/)){return"tag"}if(n.match(/^\\[,;!\/]/)){return"tag"}if(n.match(/^[\^_&]/)){return"tag"}if(n.match(/^[+\-<>|=,\/@!*:;'"`~#?]/)){return null}if(n.match(/^(\d+\.\d*|\d*\.\d+|\d+)/)){return"number"}var l=n.next();if(l=="{"||l=="}"||l=="["||l=="]"||l=="("||l==")"){return"bracket"}if(l=="%"){n.skipToEnd();return"comment"}return"error"}function g(o,n){var m=o.peek(),l;if(m=="{"||m=="["){l=h(n);l.openBracket(m);o.eat(m);e(n,f);return"bracket"}if(/[ \t\r]/.test(m)){o.eat(m);return null}e(n,f);k(n);return f(o,n)}return{startState:function(){return{cmdState:[],f:f}},copyState:function(l){return{cmdState:l.cmdState.slice(),f:l.f}},token:function(m,l){return l.f(m,l)},blankLine:function(l){l.f=f;l.cmdState.length=0},lineComment:"%"}});a.defineMIME("text/x-stex","stex");a.defineMIME("text/x-latex","stex")});